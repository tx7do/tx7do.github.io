var C=Object.defineProperty,v=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var F=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var B=(o,t,e)=>t in o?C(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,p=(o,t)=>{for(var e in t||(t={}))E.call(t,e)&&B(o,e,t[e]);if(F)for(var e of F(t))k.call(t,e)&&B(o,e,t[e]);return o},g=(o,t)=>v(o,M(t));var f=(o,t,e)=>new Promise((s,n)=>{var d=a=>{try{r(e.next(a))}catch(i){n(i)}},l=a=>{try{r(e.throw(a))}catch(i){n(i)}},r=a=>a.done?s(a.value):Promise.resolve(a.value).then(d,l);r((e=e.apply(o,t)).next())});import{B as A,u as P}from"./index.ab371c9f.js";import{B as S,u as x}from"./useForm.f49455ca.js";import{i as y,b as U,a as j}from"./system.223670c5.js";import{_ as q}from"./index.fa3b631c.js";import{B as T,r as h,u as c,j as $,a1 as b,D as L,a2 as R,a6 as N,w as O,a5 as V}from"./vendor.c791f568.js";const ee=[{title:"\u7528\u6237\u540D",dataIndex:"username",width:120},{title:"\u6635\u79F0",dataIndex:"nickname",width:120},{title:"\u90AE\u7BB1",dataIndex:"email",width:120},{title:"\u521B\u5EFA\u65F6\u95F4",dataIndex:"createTime",width:180},{title:"\u89D2\u8272",dataIndex:"role",width:200},{title:"\u5907\u6CE8",dataIndex:"remark"}],oe=[{field:"username",label:"\u7528\u6237\u540D",component:"Input",colProps:{span:8}},{field:"nickname",label:"\u6635\u79F0",component:"Input",colProps:{span:8}}],z=[{field:"username",label:"\u7528\u6237\u540D",component:"Input",helpMessage:["\u672C\u5B57\u6BB5\u6F14\u793A\u5F02\u6B65\u9A8C\u8BC1","\u4E0D\u80FD\u8F93\u5165\u5E26\u6709admin\u7684\u7528\u6237\u540D"],rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"},{validator(o,t){return new Promise((e,s)=>{y(t).then(()=>e()).catch(n=>{s(n.message||"\u9A8C\u8BC1\u5931\u8D25")})})}}]},{field:"pwd",label:"\u5BC6\u7801",component:"InputPassword",required:!0,ifShow:!1},{label:"\u89D2\u8272",field:"role",component:"ApiSelect",componentProps:{api:U,labelField:"roleName",valueField:"roleValue"},required:!0},{field:"dept",label:"\u6240\u5C5E\u90E8\u95E8",component:"TreeSelect",componentProps:{fieldNames:{label:"deptName",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0},{field:"nickname",label:"\u6635\u79F0",component:"Input",required:!0},{label:"\u90AE\u7BB1",field:"email",component:"Input",required:!0},{label:"\u5907\u6CE8",field:"remark",component:"InputTextArea"}],G=T({name:"UserModal",components:{BasicModal:A,BasicForm:S},emits:["success","register"],setup(o,{emit:t}){const e=h(!0),s=h(""),[n,{setFieldsValue:d,updateSchema:l,resetFields:r,validate:a}]=x({labelWidth:100,schemas:z,showActionButtonGroup:!1,actionColOptions:{span:23}}),[i,{setModalProps:m,closeModal:w}]=P(u=>f(this,null,function*(){r(),m({confirmLoading:!1}),e.value=!!(u==null?void 0:u.isUpdate),c(e)&&(s.value=u.record.id,d(p({},u.record)));const _=yield j();l([{field:"pwd",show:!c(e)},{field:"dept",componentProps:{treeData:_}}])})),D=$(()=>c(e)?"\u7F16\u8F91\u8D26\u53F7":"\u65B0\u589E\u8D26\u53F7");function I(){return f(this,null,function*(){try{const u=yield a();m({confirmLoading:!0}),console.log(u),w(),t("success",{isUpdate:c(e),values:g(p({},u),{id:s.value})})}finally{m({confirmLoading:!1})}})}return{registerModal:i,registerForm:n,getTitle:D,handleSubmit:I}}});function W(o,t,e,s,n,d){const l=b("BasicForm"),r=b("BasicModal");return L(),R(r,V(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:N(()=>[O(l,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}var H=q(G,[["render",W]]),te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:H});export{H as U,te as a,ee as c,oe as s};
