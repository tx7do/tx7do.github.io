var Ct=Object.defineProperty,Ft=Object.defineProperties;var St=Object.getOwnPropertyDescriptors;var Je=Object.getOwnPropertySymbols;var Pt=Object.prototype.hasOwnProperty,Bt=Object.prototype.propertyIsEnumerable;var Xe=(e,n,a)=>n in e?Ct(e,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[n]=a,P=(e,n)=>{for(var a in n||(n={}))Pt.call(n,a)&&Xe(e,a,n[a]);if(Je)for(var a of Je(n))Bt.call(n,a)&&Xe(e,a,n[a]);return e},ie=(e,n)=>Ft(e,St(n));var O=(e,n,a)=>new Promise((i,d)=>{var h=r=>{try{s(a.next(r))}catch(l){d(l)}},t=r=>{try{s(a.throw(r))}catch(l){d(l)}},s=r=>r.done?i(r.value):Promise.resolve(r.value).then(h,t);s((a=a.apply(e,n)).next())});import{B as X,bu as fe,r as N,j as U,u as c,o as Se,am as Pe,T as Z,bv as ye,a1 as R,D as k,a2 as V,a6 as D,F as te,ap as ue,ab as se,ae as x,K as H,a5 as K,bw as Ze,bx as ke,aD as we,a7 as ae,aC as re,aT as pe,w as A,J as Be,by as Qe,$ as et,bz as Le,P as _t,S as $t,b1 as De,bA as Rt,a9 as tt,t as _e,L as Me,ad as Y,bB as It,bC as Tt,bD as je,a0 as Ae,bq as Ot,bE as kt,Q as Ue,X as nt,bp as Lt,ao as Ce,bF as Dt,bG as Mt,bt as jt,b0 as ot,bH as Ut,bI as Nt,bJ as $e,bK as Et,G as Vt,H as Gt,bL as zt,b6 as Re,a$ as Ne,n as Ee,bM as Wt,Y as xt,s as Ht,V as Kt,bi as qt,b7 as Yt,b5 as Jt,aj as Xt}from"./vendor.c791f568.js";/* empty css               *//* empty css               *//* empty css               *//* empty css              *//* empty css               *//* empty css                *//* empty css               */import{p as B,ad as Ve,b as le,j as W,_ as ne,i as me,ae as ce,af as Zt,I as at,ag as Qt,a5 as en,a as st,ah as tn,B as he,h as nn,ai as on,w as an,aj as sn,ak as Ge,al as lt,am as ln,an as rn,y as un,x as cn,ao as dn,ap as fn,D as Fe,aq as ge,ar as pn,as as mn,at as ze,au as rt,av as hn,aw as gn}from"./index.687e5dce.js";import{u as Ie,C as bn}from"./index.ee593872.js";/* empty css                */import{b as it,B as ut,u as ct,a as dt}from"./index.6fb8f263.js";import{d as vn}from"./download.87e90f98.js";import{S as yn}from"./index.3a49771f.js";const wn=X({name:"ApiRadioGroup",components:{RadioGroup:fe.Group,RadioButton:fe.Button,Radio:fe},props:{api:{type:Function,default:null},params:{type:[Object,String],default:()=>({})},value:{type:[String,Number,Boolean]},isBtn:{type:[Boolean],default:!1},numberToString:B.bool,resultField:B.string.def(""),labelField:B.string.def("label"),valueField:B.string.def("value"),immediate:B.bool.def(!0)},emits:["options-change","change"],setup(e,{emit:n}){const a=N([]),i=N(!1),d=N(!0),h=N([]),t=Ve(),{t:s}=le(),[r]=Ie(e),l=U(()=>{const{labelField:b,valueField:o,numberToString:u}=e;return c(a).reduce((F,S)=>{if(S){const C=S[o];F.push(P({label:S[b],value:u?`${C}`:C},Se(S,[b,o])))}return F},[])});Pe(()=>{e.immediate&&f()}),Z(()=>e.params,()=>{!c(d)&&f()},{deep:!0});function f(){return O(this,null,function*(){const b=e.api;if(!(!b||!W(b))){a.value=[];try{i.value=!0;const o=yield b(e.params);if(Array.isArray(o)){a.value=o,p();return}e.resultField&&(a.value=ye(o,e.resultField)||[]),p()}catch(o){console.warn(o)}finally{i.value=!1}}})}function p(){n("options-change",c(l))}function m(b,...o){h.value=o}return{state:r,getOptions:l,attrs:t,loading:i,t:s,handleChange:m,props:e}}});function An(e,n,a,i,d,h){const t=R("RadioButton"),s=R("Radio"),r=R("RadioGroup");return k(),V(r,K(e.attrs,{value:e.state,"onUpdate:value":n[0]||(n[0]=l=>e.state=l),"button-style":"solid",onChange:e.handleChange}),{default:D(()=>[(k(!0),te(se,null,ue(e.getOptions,l=>(k(),te(se,{key:`${l.value}`},[e.props.isBtn?(k(),V(t,{key:0,value:l.value,disabled:l.disabled},{default:D(()=>[x(H(l.label),1)]),_:2},1032,["value","disabled"])):(k(),V(s,{key:1,value:l.value,disabled:l.disabled},{default:D(()=>[x(H(l.label),1)]),_:2},1032,["value","disabled"]))],64))),128))]),_:1},16,["value","onChange"])}var Cn=ne(wn,[["render",An]]);const Fn=X({name:"RadioButtonGroup",components:{RadioGroup:fe.Group,RadioButton:fe.Button},props:{value:{type:[String,Number,Boolean]},options:{type:Array,default:()=>[]}},setup(e){const n=Ve(),[a]=Ie(e),i=U(()=>{const{options:d}=e;return!d||(d==null?void 0:d.length)===0?[]:d.some(t=>me(t))?d.map(t=>({label:t,value:t})):d});return{state:a,getOptions:i,attrs:n}}});function Sn(e,n,a,i,d,h){const t=R("RadioButton"),s=R("RadioGroup");return k(),V(s,K(e.attrs,{value:e.state,"onUpdate:value":n[0]||(n[0]=r=>e.state=r),"button-style":"solid"}),{default:D(()=>[(k(!0),te(se,null,ue(e.getOptions,r=>(k(),V(t,{key:`${r.value}`,value:r.value,disabled:r.disabled},{default:D(()=>[x(H(r.label),1)]),_:2},1032,["value","disabled"]))),128))]),_:1},16,["value"])}var Pn=ne(Fn,[["render",Sn]]);const Bn=X({name:"ApiSelect",components:{Select:Ze,LoadingOutlined:ke},inheritAttrs:!1,props:{value:[Array,Object,String,Number],numberToString:B.bool,api:{type:Function,default:null},params:{type:Object,default:()=>({})},resultField:B.string.def(""),labelField:B.string.def("label"),valueField:B.string.def("value"),immediate:B.bool.def(!0),alwaysLoad:B.bool.def(!1)},emits:["options-change","change"],setup(e,{emit:n}){const a=N([]),i=N(!1),d=N(!0),h=N([]),t=Ve(),{t:s}=le(),[r]=Ie(e,"value","change",h),l=U(()=>{const{labelField:o,valueField:u,numberToString:F}=e;return c(a).reduce((S,C)=>{if(C){const _=C[u];S.push(ie(P({},Se(C,[o,u])),{label:C[o],value:F?`${_}`:_}))}return S},[])});Pe(()=>{e.immediate&&!e.alwaysLoad&&f()}),Z(()=>e.params,()=>{!c(d)&&f()},{deep:!0});function f(){return O(this,null,function*(){const o=e.api;if(!(!o||!W(o))){a.value=[];try{i.value=!0;const u=yield o(e.params);if(Array.isArray(u)){a.value=u,m();return}e.resultField&&(a.value=ye(u,e.resultField)||[]),m()}catch(u){console.warn(u)}finally{i.value=!1}}})}function p(o){return O(this,null,function*(){o&&(e.alwaysLoad?yield f():!e.immediate&&c(d)&&(yield f(),d.value=!1))})}function m(){n("options-change",c(l))}function b(o,...u){h.value=u}return{state:r,attrs:t,getOptions:l,loading:i,t:s,handleFetch:p,handleChange:b}}});function _n(e,n,a,i,d,h){const t=R("LoadingOutlined"),s=R("Select");return k(),V(s,K({onDropdownVisibleChange:e.handleFetch},e.$attrs,{onChange:e.handleChange,options:e.getOptions,value:e.state,"onUpdate:value":n[0]||(n[0]=r=>e.state=r)}),we({_:2},[ue(Object.keys(e.$slots),r=>({name:r,fn:D(l=>[ae(e.$slots,r,re(pe(l||{})))])})),e.loading?{name:"suffixIcon",fn:D(()=>[A(t,{spin:""})])}:void 0,e.loading?{name:"notFoundContent",fn:D(()=>[Be("span",null,[A(t,{spin:"",class:"mr-1"}),x(" "+H(e.t("component.form.apiSelectNotFound")),1)])])}:void 0]),1040,["onDropdownVisibleChange","onChange","options","value"])}var $n=ne(Bn,[["render",_n]]);const Rn=X({name:"ApiTreeSelect",components:{ATreeSelect:Qe,LoadingOutlined:ke},props:{api:{type:Function},params:{type:Object},immediate:{type:Boolean,default:!0},resultField:B.string.def("")},emits:["options-change","change"],setup(e,{attrs:n,emit:a}){const i=N([]),d=N(!1),h=N(!1),t=U(()=>P(P({},e.api?{treeData:c(i)}:{}),n));function s(...l){a("change",...l)}Z(()=>e.params,()=>{!c(d)&&r()},{deep:!0}),Z(()=>e.immediate,l=>{l&&!d.value&&r()}),et(()=>{e.immediate&&r()});function r(){return O(this,null,function*(){const{api:l}=e;if(!l||!W(l))return;h.value=!0,i.value=[];let f;try{f=yield l(e.params)}catch(p){console.error(p)}h.value=!1,!!f&&(ce(f)||(f=ye(f,e.resultField)),i.value=f||[],d.value=!0,a("options-change",i.value))})}return{getAttrs:t,loading:h,handleChange:s}}});function In(e,n,a,i,d,h){const t=R("LoadingOutlined"),s=R("a-tree-select");return k(),V(s,K(e.getAttrs,{onChange:e.handleChange}),we({_:2},[ue(Object.keys(e.$slots),r=>({name:r,fn:D(l=>[ae(e.$slots,r,re(pe(l||{})))])})),e.loading?{name:"suffixIcon",fn:D(()=>[A(t,{spin:""})])}:void 0]),1040,["onChange"])}var Tn=ne(Rn,[["render",In]]);const On=X({name:"ApiCascader",components:{LoadingOutlined:ke,[Le.name]:Le},props:{value:{type:Array},api:{type:Function,default:null},numberToString:B.bool,resultField:B.string.def(""),labelField:B.string.def("label"),valueField:B.string.def("value"),childrenField:B.string.def("children"),asyncFetchParamKey:B.string.def("parentCode"),immediate:B.bool.def(!0),initFetchParams:{type:Object,default:()=>({})},isLeaf:{type:Function,default:null},displayRenderArray:{type:Array}},emits:["change","defaultChange"],setup(e,{emit:n}){const a=N([]),i=N([]),d=N(!1),h=N([]),t=N(!0),[s]=Ie(e,"value","change",h);Z(a,b=>{const o=r(b);i.value=o},{deep:!0});function r(b){const{labelField:o,valueField:u,numberToString:F,childrenField:S,isLeaf:C}=e;return b.reduce((_,$)=>{if($){const G=$[u],v=ie(P({},Se($,[o,u])),{label:$[o],value:F?`${G}`:G,isLeaf:C&&typeof C=="function"?C($):!1}),y=Reflect.get($,S);y&&Reflect.set(v,S,r(y)),_.push(v)}return _},[])}function l(){return O(this,null,function*(){const b=e.api;if(!(!b||!W(b))){a.value=[],d.value=!0;try{const o=yield b(e.initFetchParams);if(Array.isArray(o)){a.value=o;return}e.resultField&&(a.value=ye(o,e.resultField)||[])}catch(o){console.warn(o)}finally{d.value=!1}}})}function f(b){return O(this,null,function*(){const o=b[b.length-1];o.loading=!0;const u=e.api;if(!(!u||!W(u)))try{const F=yield u({[e.asyncFetchParamKey]:Reflect.get(o,"value")});if(Array.isArray(F)){const S=r(F);o.children=S;return}if(e.resultField){const S=r(ye(F,e.resultField)||[]);o.children=S}}catch(F){console.error(F)}finally{o.loading=!1}})}Pe(()=>{e.immediate&&l()}),Z(()=>e.initFetchParams,()=>{!c(t)&&l()},{deep:!0});function p(b,o){h.value=b,n("defaultChange",b,o)}function m({labels:b,selectedOptions:o}){return c(h).length===o.length?b.join(" / "):e.displayRenderArray?e.displayRenderArray.join(" / "):""}return{state:s,options:i,loading:d,handleChange:p,loadData:f,handleRenderDisplay:m}}});function kn(e,n,a,i,d,h){const t=R("LoadingOutlined"),s=R("a-cascader");return k(),V(s,{value:e.state,"onUpdate:value":n[0]||(n[0]=r=>e.state=r),options:e.options,"load-data":e.loadData,"change-on-select":"",onChange:e.handleChange,displayRender:e.handleRenderDisplay},we({_:2},[e.loading?{name:"suffixIcon",fn:D(()=>[A(t,{spin:""})])}:void 0,e.loading?{name:"notFoundContent",fn:D(()=>[Be("span",null,[A(t,{spin:"",class:"mr-1"}),x(" "+H(e.t("component.form.apiSelectNotFound")),1)])])}:void 0]),1032,["value","options","load-data","onChange","displayRender"])}var Ln=ne(On,[["render",kn]]);const ft={helpText:{type:String,default:""},maxSize:{type:Number,default:2},maxNumber:{type:Number,default:1/0},accept:{type:Array,default:()=>[]},multiple:{type:Boolean,default:!0},uploadParams:{type:Object,default:{}},api:{type:Function,default:null,required:!0},name:{type:String,default:"file"},filename:{type:String,default:null}},Dn=ie(P({value:{type:Array,default:()=>[]}},ft),{showPreviewNumber:{type:Boolean,default:!0},emptyHidePreview:{type:Boolean,default:!1}}),Mn={value:{type:Array,default:()=>[]}},jn={columns:{type:[Array],default:null},actionColumn:{type:Object,default:null},dataSource:{type:Array,default:null}};const{t:We}=le();function Un({acceptRef:e,helpTextRef:n,maxNumberRef:a,maxSizeRef:i}){const d=U(()=>{const s=c(e);return s&&s.length>0?s:[]}),h=U(()=>c(d).map(s=>s.indexOf("/")>0||s.startsWith(".")?s:`.${s}`).join(",")),t=U(()=>{const s=c(n);if(s)return s;const r=[],l=c(e);l.length>0&&r.push(We("component.upload.accept",[l.join(",")]));const f=c(i);f&&r.push(We("component.upload.maxSize",[f]));const p=c(a);return p&&p!==1/0&&r.push(We("component.upload.maxNumber",[p])),r.join("\uFF0C")});return{getAccept:d,getStringAccept:h,getHelpText:t}}var q;(function(e){e.SUCCESS="success",e.ERROR="error",e.UPLOADING="uploading"})(q||(q={}));function Nn(e){return pt(e.name)}function pt(e){return/\.(jpg|jpeg|png|gif)$/i.test(e)}function En(e){return new Promise((n,a)=>{const i=new FileReader;i.readAsDataURL(e),i.onload=()=>n({result:i.result,file:e}),i.onerror=d=>a(d)})}const mt=Symbol("basic-table");function Xo(e){$t(mt,e)}function Vn(){return _t(mt)}const{table:Gn}=Zt,{pageSizeOptions:zn,defaultPageSize:Wn,fetchSetting:xn,defaultSize:Hn,defaultSortFn:Kn,defaultFilterFn:qn}=Gn,Zo="key",Qo=zn,ea=Wn,ta=xn,na=Hn,oa=Kn,aa=qn,sa="center",la="INDEX",Yn="ACTION";const Jn=X({name:"TableAction",components:{Icon:at,PopConfirmButton:Qt,Divider:De,Dropdown:en,MoreOutlined:Rt,Tooltip:tt},props:{actions:{type:Array,default:null},dropDownActions:{type:Array,default:null},divider:B.bool.def(!0),outside:B.bool,stopButtonPropagation:B.bool.def(!1)},setup(e){const{prefixCls:n}=st("basic-table-action");let a={};e.outside||(a=Vn());const{hasPermission:i}=tn();function d(f){const p=f.ifShow;let m=!0;return he(p)&&(m=p),W(p)&&(m=p(f)),m}const h=U(()=>(_e(e.actions)||[]).filter(f=>i(f.auth)&&d(f)).map(f=>{const{popConfirm:p}=f;return ie(P(P({getPopupContainer:()=>{var m;return(m=c(a==null?void 0:a.wrapRef.value))!=null?m:document.body},type:"link",size:"small"},f),p||{}),{onConfirm:p==null?void 0:p.confirm,onCancel:p==null?void 0:p.cancel,enable:!!p})})),t=U(()=>{const f=(_e(e.dropDownActions)||[]).filter(p=>i(p.auth)&&d(p));return f.map((p,m)=>{const{label:b,popConfirm:o}=p;return ie(P(P({},p),o),{onConfirm:o==null?void 0:o.confirm,onCancel:o==null?void 0:o.cancel,text:b,divider:m<f.length-1?e.divider:!1})})}),s=U(()=>{var m,b;const p=(((m=a==null?void 0:a.getColumns)==null?void 0:m.call(a))||[]).find(o=>o.flag===Yn);return(b=p==null?void 0:p.align)!=null?b:"left"});function r(f){return P({getPopupContainer:()=>{var p;return(p=c(a==null?void 0:a.wrapRef.value))!=null?p:document.body},placement:"bottom"},me(f)?{title:f}:f)}function l(f){if(!e.stopButtonPropagation)return;f.composedPath().find(b=>{var o;return((o=b.tagName)==null?void 0:o.toUpperCase())==="BUTTON"})&&f.stopPropagation()}return{prefixCls:n,getActions:h,getDropdownList:t,getAlign:s,onCellClick:l,getTooltip:r}}});function Xn(e,n,a,i,d,h){const t=R("Icon"),s=R("PopConfirmButton"),r=R("Tooltip"),l=R("Divider"),f=R("MoreOutlined"),p=R("a-button"),m=R("Dropdown");return k(),te("div",{class:Me([e.prefixCls,e.getAlign]),onClick:n[0]||(n[0]=(...b)=>e.onCellClick&&e.onCellClick(...b))},[(k(!0),te(se,null,ue(e.getActions,(b,o)=>(k(),te(se,{key:`${o}-${b.label}`},[b.tooltip?(k(),V(r,re(K({key:0},e.getTooltip(b.tooltip))),{default:D(()=>[A(s,re(pe(b)),{default:D(()=>[b.icon?(k(),V(t,{key:0,icon:b.icon,class:Me({"mr-1":!!b.label})},null,8,["icon","class"])):Y("v-if",!0),b.label?(k(),te(se,{key:1},[x(H(b.label),1)],2112)):Y("v-if",!0)]),_:2},1040)]),_:2},1040)):(k(),V(s,re(K({key:1},b)),{default:D(()=>[b.icon?(k(),V(t,{key:0,icon:b.icon,class:Me({"mr-1":!!b.label})},null,8,["icon","class"])):Y("v-if",!0),b.label?(k(),te(se,{key:1},[x(H(b.label),1)],2112)):Y("v-if",!0)]),_:2},1040)),e.divider&&o<e.getActions.length-1?(k(),V(l,{key:2,type:"vertical",class:"action-divider"})):Y("v-if",!0)],64))),128)),e.dropDownActions&&e.getDropdownList.length>0?(k(),V(m,{key:0,trigger:["hover"],dropMenuList:e.getDropdownList,popconfirm:""},{default:D(()=>[ae(e.$slots,"more"),e.$slots.more?Y("v-if",!0):(k(),V(p,{key:0,type:"link",size:"small"},{default:D(()=>[A(f,{class:"icon-more"})]),_:1}))]),_:3},8,["dropMenuList"])):Y("v-if",!0)],2)}var ht=ne(Jn,[["render",Xn]]);const Zn=X({components:{Image:It},props:{fileUrl:B.string.def(""),fileName:B.string.def("")}}),Qn={class:"thumb"};function eo(e,n,a,i,d,h){const t=R("Image");return k(),te("span",Qn,[e.fileUrl?(k(),V(t,{key:0,src:e.fileUrl,width:104},null,8,["src"])):Y("v-if",!0)])}var gt=ne(Zn,[["render",eo]]);const{t:Q}=le();function to(){return[{dataIndex:"thumbUrl",title:Q("component.upload.legend"),width:100,customRender:({record:e})=>{const{thumbUrl:n}=e||{};return n&&A(gt,{fileUrl:n},null)}},{dataIndex:"name",title:Q("component.upload.fileName"),align:"left",customRender:({text:e,record:n})=>{const{percent:a,status:i}=n||{};let d="normal";return i===q.ERROR?d="exception":i===q.UPLOADING?d="active":i===q.SUCCESS&&(d="success"),A("span",null,[A("p",{class:"truncate mb-1",title:e},[e]),A(Tt,{percent:a,size:"small",status:d},null)])}},{dataIndex:"size",title:Q("component.upload.fileSize"),width:100,customRender:({text:e=0})=>e&&(e/1024).toFixed(2)+"KB"},{dataIndex:"status",title:Q("component.upload.fileStatue"),width:100,customRender:({text:e})=>e===q.SUCCESS?A(je,{color:"green"},{default:()=>Q("component.upload.uploadSuccess")}):e===q.ERROR?A(je,{color:"red"},{default:()=>Q("component.upload.uploadError")}):e===q.UPLOADING?A(je,{color:"blue"},{default:()=>Q("component.upload.uploading")}):e}]}function no(e){return{width:120,title:Q("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:n})=>{const a=[{label:Q("component.upload.del"),color:"error",onClick:e.bind(null,n)}];return A(ht,{actions:a,outside:!0},null)}}}function oo(){return[{dataIndex:"url",title:Q("component.upload.legend"),width:100,customRender:({record:e})=>{const{url:n}=e||{};return pt(n)&&A(gt,{fileUrl:n},null)}},{dataIndex:"name",title:Q("component.upload.fileName"),align:"left"}]}function ao({handleRemove:e,handleDownload:n}){return{width:160,title:Q("component.upload.operating"),dataIndex:"action",fixed:!1,customRender:({record:a})=>{const i=[{label:Q("component.upload.del"),color:"error",onClick:e.bind(null,a)},{label:Q("component.upload.download"),onClick:n.bind(null,a)}];return A(ht,{actions:i,outside:!0},null)}}}const xe=[];for(let e=0;e<=15;e++)xe[e]=e.toString(16);function so(){let e="";for(let n=1;n<=36;n++)n===9||n===14||n===19||n===24?e+="-":n===15?e+=4:n===20?e+=xe[Math.random()*4|8]:e+=xe[Math.random()*16|0];return e.replace(/-/g,"")}var bt=X({name:"FileList",props:jn,setup(e){const n=it();return Z(()=>e.dataSource,()=>{Ae(()=>{var a;(a=n==null?void 0:n.redoModalHeight)==null||a.call(n)})}),()=>{const{columns:a,actionColumn:i,dataSource:d}=e,h=[...a,i];return A("table",{class:"file-table"},[A("colgroup",null,[h.map(t=>{const{width:s=0,dataIndex:r}=t,l={width:`${s}px`,minWidth:`${s}px`};return A("col",{style:s?l:{},key:r},null)})]),A("thead",null,[A("tr",{class:"file-table-tr"},[h.map(t=>{const{title:s="",align:r="center",dataIndex:l}=t;return A("th",{class:["file-table-th",r],key:l},[s])})])]),A("tbody",null,[d.map((t={},s)=>A("tr",{class:"file-table-tr",key:`${s+t.name||""}`},[h.map(r=>{const{dataIndex:l="",customRender:f,align:p="center"}=r,m=f&&W(f);return A("td",{class:["file-table-td",p],key:l},[m?f==null?void 0:f({text:t[l],record:t}):t[l]])})]))])])}}});const lo=X({components:{BasicModal:ut,Upload:Ot,Alert:kt,FileList:bt},props:ie(P({},ft),{previewFileList:{type:Array,default:()=>[]}}),emits:["change","register","delete"],setup(e,{emit:n}){const a=Ue({fileList:[]}),i=N(!1),d=N([]),{accept:h,helpText:t,maxNumber:s,maxSize:r}=nt(e),{t:l}=le(),[f,{closeModal:p}]=ct(),{getStringAccept:m,getHelpText:b}=Un({acceptRef:h,helpTextRef:t,maxNumberRef:s,maxSizeRef:r}),{createMessage:o}=nn(),u=U(()=>d.value.length>0&&!d.value.every(w=>w.status===q.SUCCESS)),F=U(()=>{const w=d.value.some(g=>g.status===q.SUCCESS);return{disabled:i.value||d.value.length===0||!w}}),S=U(()=>{const w=d.value.some(g=>g.status===q.ERROR);return i.value?l("component.upload.uploading"):l(w?"component.upload.reUploadFailed":"component.upload.startUpload")});function C(w){const{size:g,name:L}=w,{maxSize:T}=e;if(T&&w.size/1024/1024>=T)return o.error(l("component.upload.maxSizeMultiple",[T])),!1;const z={uuid:so(),file:w,size:g,name:L,percent:0,type:L.split(".").pop()};return Nn(w)?En(w).then(({result:I})=>{d.value=[...c(d),P({thumbUrl:I},z)]}):d.value=[...c(d),z],!1}function _(w){const g=d.value.findIndex(L=>L.uuid===w.uuid);g!==-1&&d.value.splice(g,1),n("delete",w)}function $(w){return O(this,null,function*(){var L;const{api:g}=e;if(!g||!W(g))return on("upload api must exist and be a function");try{w.status=q.UPLOADING;const{data:T}=yield(L=e.api)==null?void 0:L.call(e,{data:P({},e.uploadParams||{}),file:w.file,name:e.name,filename:e.filename},function(I){const j=I.loaded/I.total*100|0;w.percent=j});return w.status=q.SUCCESS,w.responseData=T,{success:!0,error:null}}catch(T){return console.log(T),w.status=q.ERROR,{success:!1,error:T}}})}function G(){return O(this,null,function*(){var g;const{maxNumber:w}=e;if(d.value.length+((g=e.previewFileList)==null?void 0:g.length)>w)return o.warning(l("component.upload.maxNumber",[w]));try{i.value=!0;const L=d.value.filter(I=>I.status!==q.SUCCESS)||[],T=yield Promise.all(L.map(I=>$(I)));i.value=!1;const z=T.filter(I=>!I.success);if(z.length>0)throw z}catch(L){throw i.value=!1,L}})}function v(){const{maxNumber:w}=e;if(d.value.length>w)return o.warning(l("component.upload.maxNumber",[w]));if(i.value)return o.warning(l("component.upload.saveWarn"));const g=[];for(const L of d.value){const{status:T,responseData:z}=L;T===q.SUCCESS&&z&&g.push(z.url)}if(g.length<=0)return o.warning(l("component.upload.saveError"));d.value=[],p(),n("change",g)}function y(){return O(this,null,function*(){return i.value?(o.warning(l("component.upload.uploadWait")),!1):(d.value=[],!0)})}return{columns:to(),actionColumn:no(_),register:f,closeModal:p,getHelpText:b,getStringAccept:m,getOkButtonProps:F,beforeUpload:C,fileListRef:d,state:a,isUploadingRef:i,handleStartUpload:G,handleOk:v,handleCloseFunc:y,getIsSelectFile:u,getUploadBtnText:S,t:l}}}),ro={class:"upload-modal-toolbar"};function io(e,n,a,i,d,h){const t=R("a-button"),s=R("Alert"),r=R("Upload"),l=R("FileList"),f=R("BasicModal");return k(),V(f,K({width:"800px",title:e.t("component.upload.upload"),okText:e.t("component.upload.save")},e.$attrs,{onRegister:e.register,onOk:e.handleOk,closeFunc:e.handleCloseFunc,maskClosable:!1,keyboard:!1,class:"upload-modal",okButtonProps:e.getOkButtonProps,cancelButtonProps:{disabled:e.isUploadingRef}}),{centerFooter:D(()=>[A(t,{onClick:e.handleStartUpload,color:"success",disabled:!e.getIsSelectFile,loading:e.isUploadingRef},{default:D(()=>[x(H(e.getUploadBtnText),1)]),_:1},8,["onClick","disabled","loading"])]),default:D(()=>[Be("div",ro,[A(s,{message:e.getHelpText,type:"info",banner:"",class:"upload-modal-toolbar__text"},null,8,["message"]),A(r,{accept:e.getStringAccept,multiple:e.multiple,"before-upload":e.beforeUpload,"show-upload-list":!1,class:"upload-modal-toolbar__btn"},{default:D(()=>[A(t,{type:"primary"},{default:D(()=>[x(H(e.t("component.upload.choose")),1)]),_:1})]),_:1},8,["accept","multiple","before-upload"])]),A(l,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","okText","onRegister","onOk","closeFunc","okButtonProps","cancelButtonProps"])}var uo=ne(lo,[["render",io]]);const co=X({components:{BasicModal:ut,FileList:bt},props:Mn,emits:["list-change","register","delete"],setup(e,{emit:n}){const[a,{closeModal:i}]=ct(),{t:d}=le(),h=N([]);Z(()=>e.value,r=>{ce(r)||(r=[]),h.value=r.filter(l=>!!l).map(l=>({url:l,type:l.split(".").pop()||"",name:l.split("/").pop()||""}))},{immediate:!0});function t(r){const l=h.value.findIndex(f=>f.url===r.url);if(l!==-1){const f=h.value.splice(l,1);n("delete",f[0].url),n("list-change",h.value.map(p=>p.url))}}function s(r){const{url:l=""}=r;vn({url:l})}return{t:d,register:a,closeModal:i,fileListRef:h,columns:oo(),actionColumn:ao({handleRemove:t,handleDownload:s})}}});function fo(e,n,a,i,d,h){const t=R("FileList"),s=R("BasicModal");return k(),V(s,K({width:"800px",title:e.t("component.upload.preview"),class:"upload-preview-modal"},e.$attrs,{onRegister:e.register,showOkBtn:!1}),{default:D(()=>[A(t,{dataSource:e.fileListRef,columns:e.columns,actionColumn:e.actionColumn},null,8,["dataSource","columns","actionColumn"])]),_:1},16,["title","onRegister"])}var po=ne(co,[["render",fo]]);const mo=X({name:"BasicUpload",components:{UploadModal:uo,Space:Lt,UploadPreviewModal:po,Icon:at,Tooltip:tt},props:Dn,emits:["change","delete","preview-delete","update:value"],setup(e,{emit:n,attrs:a}){const{t:i}=le(),[d,{openModal:h}]=dt(),[t,{openModal:s}]=dt(),r=N([]),l=U(()=>{const{emptyHidePreview:u}=e;return u&&u?r.value.length>0:!0}),f=U(()=>{const u=P(P({},a),e);return Se(u,"onChange")});Z(()=>e.value,(u=[])=>{r.value=ce(u)?u:[]},{immediate:!0});function p(u){r.value=[...c(r),...u||[]],n("update:value",r.value),n("change",r.value)}function m(u){r.value=[...u||[]],n("update:value",r.value),n("change",r.value)}function b(u){n("delete",u)}function o(u){n("preview-delete",u)}return{registerUploadModal:d,openUploadModal:h,handleChange:p,handlePreviewChange:m,registerPreviewModal:t,openPreviewModal:s,fileList:r,showPreview:l,bindValue:f,handleDelete:b,handlePreviewDelete:o,t:i}}});function ho(e,n,a,i,d,h){const t=R("a-button"),s=R("Icon"),r=R("Tooltip"),l=R("Space"),f=R("UploadModal"),p=R("UploadPreviewModal");return k(),te("div",null,[A(l,null,{default:D(()=>[A(t,{type:"primary",onClick:e.openUploadModal,preIcon:"carbon:cloud-upload"},{default:D(()=>[x(H(e.t("component.upload.upload")),1)]),_:1},8,["onClick"]),e.showPreview?(k(),V(r,{key:0,placement:"bottom"},{title:D(()=>[x(H(e.t("component.upload.uploaded"))+" ",1),e.fileList.length?(k(),te(se,{key:0},[x(H(e.fileList.length),1)],2112)):Y("v-if",!0)]),default:D(()=>[A(t,{onClick:e.openPreviewModal},{default:D(()=>[A(s,{icon:"bi:eye"}),e.fileList.length&&e.showPreviewNumber?(k(),te(se,{key:0},[x(H(e.fileList.length),1)],2112)):Y("v-if",!0)]),_:1},8,["onClick"])]),_:1})):Y("v-if",!0)]),_:1}),A(f,K(e.bindValue,{previewFileList:e.fileList,onRegister:e.registerUploadModal,onChange:e.handleChange,onDelete:e.handleDelete}),null,16,["previewFileList","onRegister","onChange","onDelete"]),A(p,{value:e.fileList,onRegister:e.registerPreviewModal,onListChange:e.handlePreviewChange,onDelete:e.handlePreviewDelete},null,8,["value","onRegister","onListChange","onDelete"])])}var go=ne(mo,[["render",ho]]);const bo=an(go),M=new Map;M.set("Input",Ce);M.set("InputGroup",Ce.Group);M.set("InputPassword",Ce.Password);M.set("InputSearch",Ce.Search);M.set("InputTextArea",Ce.TextArea);M.set("InputNumber",Dt);M.set("AutoComplete",Mt);M.set("Select",Ze);M.set("ApiSelect",$n);M.set("TreeSelect",Qe);M.set("ApiTreeSelect",Tn);M.set("ApiRadioGroup",Cn);M.set("Switch",jt);M.set("RadioButtonGroup",Pn);M.set("RadioGroup",fe.Group);M.set("Checkbox",ot);M.set("CheckboxGroup",ot.Group);M.set("ApiCascader",Ln);M.set("Cascader",Le);M.set("Slider",Ut);M.set("Rate",Nt);M.set("DatePicker",$e);M.set("MonthPicker",$e.MonthPicker);M.set("RangePicker",$e.RangePicker);M.set("WeekPicker",$e.WeekPicker);M.set("TimePicker",Et);M.set("StrengthMeter",yn);M.set("IconPicker",sn);M.set("InputCountDown",bn);M.set("Upload",bo);M.set("Divider",De);const{t:He}=le();function vt(e){return e.includes("Input")||e.includes("Complete")?He("common.inputText"):e.includes("Picker")||e.includes("Select")||e.includes("Cascader")||e.includes("Checkbox")||e.includes("Radio")||e.includes("Switch")?He("common.chooseText"):""}const vo=["DatePicker","MonthPicker","WeekPicker","TimePicker"];function yo(){return[...vo,"RangePicker"]}function wo(e,n,a){["DatePicker","MonthPicker","WeekPicker","TimePicker"].includes(n)?e.type=a?"string":"object":["RangePicker","Upload","CheckboxGroup","TimePicker"].includes(n)?e.type="array":["InputNumber"].includes(n)&&(e.type="number")}function Ao(e,n){return e&&["Input","InputPassword","InputSearch","InputTextArea"].includes(e)&&n&&Ge(n)?`${n}`:n}const yt=yo();function Co(e,n){return U(()=>{const a=c(e),{labelCol:i={},wrapperCol:d={}}=a.itemProps||{},{labelWidth:h,disabledLabelWidth:t}=a,{labelWidth:s,labelCol:r,wrapperCol:l}=c(n);if(!s&&!h&&!r||t)return i.style={textAlign:"left"},{labelCol:i,wrapperCol:d};let f=h||s;const p=P(P({},r),i),m=P(P({},l),d);return f&&(f=Ge(f)?`${f}px`:f),{labelCol:P({style:{width:f}},p),wrapperCol:P({style:{width:`calc(100% - ${f})`}},m)}})}function Ke(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!zt(e)}var Fo=X({name:"BasicFormItem",inheritAttrs:!1,props:{schema:{type:Object,default:()=>({})},formProps:{type:Object,default:()=>({})},allDefaultValues:{type:Object,default:()=>({})},formModel:{type:Object,default:()=>({})},setFormModel:{type:Function,default:null},tableAction:{type:Object},formActionType:{type:Object}},setup(e,{slots:n}){const{t:a}=le(),{schema:i,formProps:d}=nt(e),h=Co(i,d),t=U(()=>{const{allDefaultValues:o,formModel:u,schema:F}=e,{mergeDynamicData:S}=e.formProps;return{field:F.field,model:u,values:P(P(P({},S),o),u),schema:F}}),s=U(()=>{var _;const{schema:o,tableAction:u,formModel:F,formActionType:S}=e;let{componentProps:C={}}=o;return W(C)&&(C=(_=C({schema:o,tableAction:u,formModel:F,formActionType:S}))!=null?_:{}),o.component==="Divider"&&(C=Object.assign({type:"horizontal"},C,{orientation:"left",plain:!0})),C}),r=U(()=>{const{disabled:o}=e.formProps,{dynamicDisabled:u}=e.schema,{disabled:F=!1}=c(s);let S=!!o||F;return he(u)&&(S=u),W(u)&&(S=u(c(t))),S});function l(){const{show:o,ifShow:u}=e.schema,{showAdvancedButton:F}=e.formProps,S=F&&he(e.schema.isAdvanced)?e.schema.isAdvanced:!0;let C=!0,_=!0;return he(o)&&(C=o),he(u)&&(_=u),W(o)&&(C=o(c(t))),W(u)&&(_=u(c(t))),C=C&&S,{isShow:C,isIfShow:_}}function f(){var z;const{rules:o=[],component:u,rulesMessageJoinLabel:F,label:S,dynamicRules:C,required:_}=e.schema;if(W(C))return C(c(t));let $=Ee(o);const{rulesMessageJoinLabel:G}=e.formProps,v=Reflect.has(e.schema,"rulesMessageJoinLabel")?F:G,y=vt(u)+`${v?S:""}`;function w(I,j){const ee=I.message||y;return j===void 0||rn(j)||Array.isArray(j)&&j.length===0||typeof j=="string"&&j.trim()===""||typeof j=="object"&&Reflect.has(j,"checked")&&Reflect.has(j,"halfChecked")&&Array.isArray(j.checked)&&Array.isArray(j.halfChecked)&&j.checked.length===0&&j.halfChecked.length===0?Promise.reject(ee):Promise.resolve()}const g=W(_)?_(c(t)):_;(!$||$.length===0)&&g&&($=[{required:g,validator:w}]);const L=$.findIndex(I=>Reflect.has(I,"required")&&!Reflect.has(I,"validator"));if(L!==-1){const I=$[L],{isShow:j}=l();if(j||(I.required=!1),u){Reflect.has(I,"type")||(I.type=u==="InputNumber"?"number":"string"),I.message=I.message||y,(u.includes("Input")||u.includes("Textarea"))&&(I.whitespace=!0);const ee=(z=c(s))==null?void 0:z.valueFormat;wo(I,u,ee)}}const T=$.findIndex(I=>I.max);return T!==-1&&!$[T].validator&&($[T].message=$[T].message||a("component.form.maxTip",[$[T].max])),$}function p(){var j;const{renderComponentContent:o,component:u,field:F,changeEvent:S="change",valueField:C}=e.schema,_=u&&["Switch","Checkbox"].includes(u),$=`on${Wt(S)}`,G={[$]:(...ee)=>{const[be]=ee;g[$]&&g[$](...ee);const ve=be?be.target:null,Te=ve?_?ve.checked:ve.value:be;e.setFormModel(F,Te)}},v=M.get(u),{autoSetPlaceHolder:y,size:w}=e.formProps,g=ie(P({allowClear:!0,getPopupContainer:ee=>ee.parentNode,size:w},c(s)),{disabled:c(r)});!g.disabled&&y&&u!=="RangePicker"&&u&&(g.placeholder=((j=c(s))==null?void 0:j.placeholder)||vt(u)),g.codeField=F,g.formValues=c(t);const T={[C||(_?"checked":"value")]:e.formModel[F]},z=P(P(P({},g),G),T);if(!o)return A(v,z,null);const I=W(o)?P({},o(c(t))):{default:()=>o};return A(v,z,Ke(I)?I:{default:()=>[I]})}function m(){const{label:o,helpMessage:u,helpComponentProps:F,subLabel:S}=e.schema,C=S?A("span",null,[o,x(" "),A("span",{class:"text-secondary"},[S])]):o,_=W(u)?u(c(t)):u;return!_||Array.isArray(_)&&_.length===0?C:A("span",null,[C,A(ln,K({placement:"top",class:"mx-1",text:_},F),null)])}function b(){const{itemProps:o,slot:u,render:F,field:S,suffix:C,component:_}=e.schema,{labelCol:$,wrapperCol:G}=c(h),{colon:v}=e.formProps;if(_==="Divider"){let y;return A(Re,{span:24},{default:()=>[A(De,c(s),Ke(y=m())?y:{default:()=>[y]})]})}else{const y=()=>u?lt(n,u,c(t)):F?F(c(t)):p(),w=!!C,g=W(C)?C(c(t)):C;return A(Ne.Item,K({name:S,colon:v,class:{"suffix-item":w}},o,{label:m(),rules:f(),labelCol:$,wrapperCol:G}),{default:()=>[A("div",{style:"display:flex"},[A("div",{style:"flex:1;"},[y()]),w&&A("span",{class:"suffix"},[g])])]})}}return()=>{let o;const{colProps:u={},colSlot:F,renderColContent:S,component:C}=e.schema;if(!M.has(C))return null;const{baseColProps:_={}}=e.formProps,$=P(P({},_),u),{isIfShow:G,isShow:v}=l(),y=c(t);return G&&Vt(A(Re,$,Ke(o=(()=>F?lt(n,F,y):S?S(y):b())())?o:{default:()=>[o]}),[[Gt,v]])}}});const wt=Symbol();function So(e){return cn(e,wt)}function Po(){return un(wt)}const Bo=X({name:"BasicFormAction",components:{FormItem:Ne.Item,Button:dn,BasicArrow:fn,[Re.name]:Re},props:{showActionButtonGroup:B.bool.def(!0),showResetButton:B.bool.def(!0),showSubmitButton:B.bool.def(!0),showAdvancedButton:B.bool.def(!0),resetButtonOptions:{type:Object,default:()=>({})},submitButtonOptions:{type:Object,default:()=>({})},actionColOptions:{type:Object,default:()=>({})},actionSpan:B.number.def(6),isAdvanced:B.bool,hideAdvanceBtn:B.bool},emits:["toggle-advanced"],setup(e,{emit:n}){const{t:a}=le(),i=U(()=>{const{showAdvancedButton:s,actionSpan:r,actionColOptions:l}=e,f=24-r,p=s?{span:f<6?24:f}:{};return P(P({style:{textAlign:"right"},span:s?6:4},p),l)}),d=U(()=>Object.assign({text:a("common.resetText")},e.resetButtonOptions)),h=U(()=>Object.assign({text:a("common.queryText")},e.submitButtonOptions));function t(){n("toggle-advanced")}return P({t:a,actionColOpt:i,getResetBtnOptions:d,getSubmitBtnOptions:h,toggleAdvanced:t},Po())}});function _o(e,n,a,i,d,h){const t=R("Button"),s=R("BasicArrow"),r=R("FormItem"),l=R("a-col");return e.showActionButtonGroup?(k(),V(l,re(K({key:0},e.actionColOpt)),{default:D(()=>[Be("div",{style:xt([{width:"100%"},{textAlign:e.actionColOpt.style.textAlign}])},[A(r,null,{default:D(()=>[ae(e.$slots,"resetBefore"),e.showResetButton?(k(),V(t,K({key:0,type:"default",class:"mr-2"},e.getResetBtnOptions,{onClick:e.resetAction}),{default:D(()=>[x(H(e.getResetBtnOptions.text),1)]),_:1},16,["onClick"])):Y("v-if",!0),ae(e.$slots,"submitBefore"),e.showSubmitButton?(k(),V(t,K({key:1,type:"primary",class:"mr-2"},e.getSubmitBtnOptions,{onClick:e.submitAction}),{default:D(()=>[x(H(e.getSubmitBtnOptions.text),1)]),_:1},16,["onClick"])):Y("v-if",!0),ae(e.$slots,"advanceBefore"),e.showAdvancedButton&&!e.hideAdvanceBtn?(k(),V(t,{key:2,type:"link",size:"small",onClick:e.toggleAdvanced},{default:D(()=>[x(H(e.isAdvanced?e.t("component.form.putAway"):e.t("component.form.unfold"))+" ",1),A(s,{class:"ml-1",expand:!e.isAdvanced,up:""},null,8,["expand"])]),_:1},8,["onClick"])):Y("v-if",!0),ae(e.$slots,"advanceAfter")]),_:3})],4)]),_:3},16)):Y("v-if",!0)}var $o=ne(Bo,[["render",_o]]);function Ro({defaultValueRef:e,getSchema:n,formModel:a,getProps:i}){function d(s){var l,f;if(!Fe(s))return{};const r={};for(const p of Object.entries(s)){let[,m]=p;const[b]=p;if(!b||ce(m)&&m.length===0||W(m))continue;const o=c(i).transformDateFunc;Fe(m)&&(m=o==null?void 0:o(m)),ce(m)&&((l=m[0])==null?void 0:l.format)&&((f=m[1])==null?void 0:f.format)&&(m=m.map(u=>o==null?void 0:o(u))),me(m)&&(m=m.trim()),Ht(r,b,m)}return h(r)}function h(s){const r=c(i).fieldMapToTime;if(!r||!Array.isArray(r))return s;for(const[l,[f,p],m="YYYY-MM-DD"]of r){if(!l||!f||!p||!s[l])continue;const[b,o]=s[l];s[f]=ge(b).format(m),s[p]=ge(o).format(m),Reflect.deleteProperty(s,l)}return s}function t(){const s=c(n),r={};s.forEach(l=>{const{defaultValue:f}=l;pn(f)||(r[l.field]=f,a[l.field]=f)}),e.value=r}return{handleFormValues:d,initDefault:t}}const de=24;function Io({advanceState:e,emit:n,getProps:a,getSchema:i,formModel:d,defaultValueRef:h}){const{realWidthRef:t,screenEnum:s,screenRef:r}=mn(),l=U(()=>{if(!e.isAdvanced)return 0;const o=c(a).emptySpan||0;if(Ge(o))return o;if(Fe(o)){const{span:u=0}=o,F=c(r);return o[F.toLowerCase()]||u||0}return 0}),f=Kt(m,30);Z([()=>c(i),()=>e.isAdvanced,()=>c(t)],()=>{const{showAdvancedButton:o}=c(a);o&&f()},{immediate:!0});function p(o,u=0,F=!1){const S=c(t),C=parseInt(o.md)||parseInt(o.xs)||parseInt(o.sm)||o.span||de,_=parseInt(o.lg)||C,$=parseInt(o.xl)||_,G=parseInt(o.xxl)||$;return S<=s.LG?u+=C:S<s.XL?u+=_:S<s.XXL?u+=$:u+=G,F?(e.hideAdvanceBtn=!1,u<=de*2?(e.hideAdvanceBtn=!0,e.isAdvanced=!0):u>de*2&&u<=de*(c(a).autoAdvancedLine||3)?e.hideAdvanceBtn=!1:e.isLoad||(e.isLoad=!0,e.isAdvanced=!e.isAdvanced),{isAdvanced:e.isAdvanced,itemColSum:u}):u>de*(c(a).alwaysShowLines||1)?{isAdvanced:e.isAdvanced,itemColSum:u}:{isAdvanced:!0,itemColSum:u}}function m(){let o=0,u=0;const{baseColProps:F={}}=c(a);for(const S of c(i)){const{show:C,colProps:_}=S;let $=!0;if(he(C)&&($=C),W(C)&&($=C({schema:S,model:d,field:S.field,values:P(P({},c(h)),d)})),$&&(_||F)){const{itemColSum:G,isAdvanced:v}=p(P(P({},F),_),o);o=G||0,v&&(u=o),S.isAdvanced=v}}e.actionSpan=u%de+c(l),p(c(a).actionColOptions||{span:de},o,!0),n("advanced-change")}function b(){e.isAdvanced=!e.isAdvanced}return{handleToggleAdvanced:b}}function To({emit:e,getProps:n,formModel:a,getSchema:i,defaultValueRef:d,formElRef:h,schemaRef:t,handleFormValues:s}){function r(){return O(this,null,function*(){const{resetFunc:v,submitOnReset:y}=c(n);v&&W(v)&&(yield v()),!!c(h)&&(Object.keys(a).forEach(g=>{a[g]=d.value[g]}),Ae(()=>_()),e("reset",_e(a)),y&&G())})}function l(v){return O(this,null,function*(){const y=c(i).map(g=>g.field).filter(Boolean),w=[];Object.keys(v).forEach(g=>{const L=c(i).find(I=>I.field===g);let T=v[g];const z=Reflect.has(v,g);if(T=Ao(L==null?void 0:L.component,T),z&&y.includes(g)){if(F(g))if(Array.isArray(T)){const I=[];for(const j of T)I.push(j?ge(j):null);a[g]=I}else{const{componentProps:I}=L||{};let j=I;typeof I=="function"&&(j=j({formModel:a})),a[g]=T?(j==null?void 0:j.valueFormat)?T:ge(T):null}else a[g]=T;w.push(g)}}),S(w).catch(g=>{})})}function f(v){return O(this,null,function*(){const y=Ee(c(i));if(!v)return;let w=me(v)?[v]:v;me(v)&&(w=[v]);for(const g of w)p(g,y);t.value=y})}function p(v,y){if(me(v)){const w=y.findIndex(g=>g.field===v);w!==-1&&(delete a[v],y.splice(w,1))}}function m(v,y,w=!1){return O(this,null,function*(){const g=Ee(c(i)),L=g.findIndex(T=>T.field===y);if(!y||L===-1||w){w?g.unshift(v):g.push(v),t.value=g;return}L!==-1&&g.splice(L+1,0,v),t.value=g})}function b(v){return O(this,null,function*(){let y=[];if(Fe(v)&&y.push(v),ce(v)&&(y=[...v]),!y.every(g=>g.component==="Divider"||Reflect.has(g,"field")&&g.field)){ze("All children of the form Schema array that need to be updated must contain the `field` field");return}t.value=y})}function o(v){return O(this,null,function*(){let y=[];if(Fe(v)&&y.push(v),ce(v)&&(y=[...v]),!y.every(L=>L.component==="Divider"||Reflect.has(L,"field")&&L.field)){ze("All children of the form Schema array that need to be updated must contain the `field` field");return}const g=[];y.forEach(L=>{c(i).forEach(T=>{if(T.field===L.field){const z=rt(T,L);g.push(z)}else g.push(T)})}),t.value=qt(g,"field")})}function u(){return c(h)?s(_e(c(a))):{}}function F(v){return c(i).some(y=>y.field===v?yt.includes(y.component):!1)}function S(v){return O(this,null,function*(){var y;return(y=c(h))==null?void 0:y.validateFields(v)})}function C(v){return O(this,null,function*(){var y;return yield(y=c(h))==null?void 0:y.validate(v)})}function _(v){return O(this,null,function*(){var y;yield(y=c(h))==null?void 0:y.clearValidate(v)})}function $(v,y){return O(this,null,function*(){var w;yield(w=c(h))==null?void 0:w.scrollToField(v,y)})}function G(v){return O(this,null,function*(){v&&v.preventDefault();const{submitFunc:y}=c(n);if(y&&W(y)){yield y();return}if(!!c(h))try{const g=yield C(),L=s(g);e("submit",L)}catch(g){throw new Error(g)}})}return{handleSubmit:G,clearValidate:_,validate:C,validateFields:S,getFieldsValue:u,updateSchema:o,resetSchema:b,appendSchemaByField:m,removeSchemaByFiled:f,resetFields:r,setFieldsValue:l,scrollToField:$}}function Oo(d){return O(this,arguments,function*({getSchema:e,getProps:n,formElRef:a,isInitedDefault:i}){Pe(()=>O(this,null,function*(){if(c(i)||!c(n).autoFocusFirstItem)return;yield Ae();const h=c(e),t=c(a),s=t==null?void 0:t.$el;if(!t||!s||!h||h.length===0||!h[0].component.includes("Input"))return;const l=s.querySelector(".ant-row:first-child input");!l||l==null||l.focus()}))})}const ko={model:{type:Object,default:{}},labelWidth:{type:[Number,String],default:0},fieldMapToTime:{type:Array,default:()=>[]},compact:B.bool,schemas:{type:[Array],default:()=>[]},mergeDynamicData:{type:Object,default:null},baseRowStyle:{type:Object},baseColProps:{type:Object},autoSetPlaceHolder:B.bool.def(!0),autoSubmitOnEnter:B.bool.def(!1),submitOnReset:B.bool,size:B.oneOf(["default","small","large"]).def("default"),disabled:B.bool,emptySpan:{type:[Number,Object],default:0},showAdvancedButton:B.bool,transformDateFunc:{type:Function,default:e=>{var n,a;return(a=(n=e==null?void 0:e.format)==null?void 0:n.call(e,"YYYY-MM-DD HH:mm:ss"))!=null?a:e}},rulesMessageJoinLabel:B.bool.def(!0),autoAdvancedLine:B.number.def(3),alwaysShowLines:B.number.def(1),showActionButtonGroup:B.bool.def(!0),actionColOptions:Object,showResetButton:B.bool.def(!0),autoFocusFirstItem:B.bool,resetButtonOptions:Object,showSubmitButton:B.bool.def(!0),submitButtonOptions:Object,resetFunc:Function,submitFunc:Function,hideRequiredMark:B.bool,labelCol:Object,layout:B.oneOf(["horizontal","vertical","inline"]).def("horizontal"),tableAction:{type:Object},wrapperCol:Object,colon:B.bool,labelAlign:B.string,rowProps:Object};const Lo=X({name:"BasicForm",components:{FormItem:Fo,Form:Ne,Row:Yt,FormAction:$o},props:ko,emits:["advanced-change","reset","submit","register"],setup(e,{emit:n,attrs:a}){const i=Ue({}),d=it(),h=Ue({isAdvanced:!0,hideAdvanceBtn:!1,isLoad:!1,actionSpan:6}),t=N({}),s=N(!1),r=N({}),l=N(null),f=N(null),{prefixCls:p}=st("basic-form"),m=U(()=>P(P({},e),c(r))),b=U(()=>[p,{[`${p}--compact`]:c(m).compact}]),o=U(()=>{const{baseRowStyle:E={},rowProps:J}=c(m);return P({style:E},J)}),u=U(()=>P(P(P({},a),e),c(m))),F=U(()=>{const E=c(l)||c(m).schemas;for(const J of E){const{defaultValue:oe,component:qe}=J;if(oe&&yt.includes(qe))if(!Array.isArray(oe))J.defaultValue=ge(oe);else{const Ye=[];oe.forEach(At=>{Ye.push(ge(At))}),J.defaultValue=Ye}}return c(m).showAdvancedButton?E.filter(J=>J.component!=="Divider"):E}),{handleToggleAdvanced:S}=Io({advanceState:h,emit:n,getProps:m,getSchema:F,formModel:i,defaultValueRef:t}),{handleFormValues:C,initDefault:_}=Ro({getProps:m,defaultValueRef:t,getSchema:F,formModel:i});Oo({getSchema:F,getProps:m,isInitedDefault:s,formElRef:f});const{handleSubmit:$,setFieldsValue:G,clearValidate:v,validate:y,validateFields:w,getFieldsValue:g,updateSchema:L,resetSchema:T,appendSchemaByField:z,removeSchemaByFiled:I,resetFields:j,scrollToField:ee}=To({emit:n,getProps:m,formModel:i,getSchema:F,defaultValueRef:t,formElRef:f,schemaRef:l,handleFormValues:C});So({resetAction:j,submitAction:$}),Z(()=>c(m).model,()=>{const{model:E}=c(m);!E||G(E)},{immediate:!0}),Z(()=>c(m).schemas,E=>{T(E!=null?E:[])}),Z(()=>F.value,E=>{Ae(()=>{var J;(J=d==null?void 0:d.redoModalHeight)==null||J.call(d)}),!c(s)&&(E==null?void 0:E.length)&&(_(),s.value=!0)});function be(E){return O(this,null,function*(){r.value=rt(c(r)||{},E)})}function ve(E,J){i[E]=J;const{validateTrigger:oe}=c(u);(!oe||oe==="change")&&w([E]).catch(qe=>{})}function Te(E){const{autoSubmitOnEnter:J}=c(m);if(!!J&&E.key==="Enter"&&E.target&&E.target instanceof HTMLElement){const oe=E.target;oe&&oe.tagName&&oe.tagName.toUpperCase()=="INPUT"&&$()}}const Oe={getFieldsValue:g,setFieldsValue:G,resetFields:j,updateSchema:L,resetSchema:T,setProps:be,removeSchemaByFiled:I,appendSchemaByField:z,clearValidate:v,validateFields:w,validate:y,submit:$,scrollToField:ee};return et(()=>{_(),n("register",Oe)}),P({getBindValue:u,handleToggleAdvanced:S,handleEnterPress:Te,formModel:i,defaultValueRef:t,advanceState:h,getRow:o,getProps:m,formElRef:f,getSchema:F,formActionType:Oe,setFormModel:ve,getFormClass:b,getFormActionBindProps:U(()=>P(P({},m.value),h))},Oe)}});function Do(e,n,a,i,d,h){const t=R("FormItem"),s=R("FormAction"),r=R("Row"),l=R("Form");return k(),V(l,K(e.getBindValue,{class:e.getFormClass,ref:"formElRef",model:e.formModel,onKeypress:Jt(e.handleEnterPress,["enter"])}),{default:D(()=>[A(r,re(pe(e.getRow)),{default:D(()=>[ae(e.$slots,"formHeader"),(k(!0),te(se,null,ue(e.getSchema,f=>(k(),V(t,{key:f.field,tableAction:e.tableAction,formActionType:e.formActionType,schema:f,formProps:e.getProps,allDefaultValues:e.defaultValueRef,formModel:e.formModel,setFormModel:e.setFormModel},we({_:2},[ue(Object.keys(e.$slots),p=>({name:p,fn:D(m=>[ae(e.$slots,p,re(pe(m||{})))])}))]),1032,["tableAction","formActionType","schema","formProps","allDefaultValues","formModel","setFormModel"]))),128)),A(s,K(e.getFormActionBindProps,{onToggleAdvanced:e.handleToggleAdvanced}),we({_:2},[ue(["resetBefore","submitBefore","advanceBefore","advanceAfter"],f=>({name:f,fn:D(p=>[ae(e.$slots,f,re(pe(p||{})))])}))]),1040,["onToggleAdvanced"]),ae(e.$slots,"formFooter")]),_:3},16)]),_:3},16,["class","model","onKeypress"])}var ra=ne(Lo,[["render",Do]]);function ia(e){const n=N(null),a=N(!1);function i(){return O(this,null,function*(){const t=c(n);return t||ze("The form instance has not been obtained, please make sure that the form has been rendered when performing the form operation!"),yield Ae(),t})}function d(t){Xt(()=>{n.value=null,a.value=null}),!(c(a)&&hn()&&t===c(n))&&(n.value=t,a.value=!0,Z(()=>e,()=>{e&&t.setProps(gn(e))},{immediate:!0,deep:!0}))}return[d,{scrollToField:(t,s)=>O(this,null,function*(){(yield i()).scrollToField(t,s)}),setProps:t=>O(this,null,function*(){(yield i()).setProps(t)}),updateSchema:t=>O(this,null,function*(){(yield i()).updateSchema(t)}),resetSchema:t=>O(this,null,function*(){(yield i()).resetSchema(t)}),clearValidate:t=>O(this,null,function*(){(yield i()).clearValidate(t)}),resetFields:()=>O(this,null,function*(){i().then(t=>O(this,null,function*(){yield t.resetFields()}))}),removeSchemaByFiled:t=>O(this,null,function*(){var s;(s=c(n))==null||s.removeSchemaByFiled(t)}),getFieldsValue:()=>{var t;return(t=c(n))==null?void 0:t.getFieldsValue()},setFieldsValue:t=>O(this,null,function*(){(yield i()).setFieldsValue(t)}),appendSchemaByField:(t,s,r)=>O(this,null,function*(){(yield i()).appendSchemaByField(t,s,r)}),submit:()=>O(this,null,function*(){return(yield i()).submit()}),validate:t=>O(this,null,function*(){return(yield i()).validate(t)}),validateFields:t=>O(this,null,function*(){return(yield i()).validateFields(t)})}]}export{$n as A,ra as B,sa as D,ta as F,la as I,ea as P,Zo as R,ht as T,Qo as a,Tn as b,Vn as c,Yn as d,so as e,oa as f,aa as g,na as h,Xo as i,ia as u};
