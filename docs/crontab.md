# crontab

## 什么是cron表达式？

cron表达式是一个具有时间含义的字符串，一般用于定义定时任务的执行时间。

## cron表达式的格式

cron使用6-7位制的格式：

```text
{秒数} {分钟} {小时} {日期} {月份} {星期} {年份（可为空）}
```

## crontab表达式的格式

crontab使用的五位制格式：

```text
{分钟} {小时} {日期} {月份} {星期}
```

## cron表达式每个字段的允许值

| 域         | 允许的数值      | 允许的特殊字符          | 备注 |
| ---------- | --------------- | ----------------------- | ---- |
| 秒         | 0-59            | - * /                   |      |
| 分         | 0-59            | - * /                   |      |
| 小时       | 0-23            | - * /                   |      |
| 日期       | 1-31            | - * ? / L W C           |      |
| 月份       | 1-12            | JAN-DEC , - * /         |      |
| 星期       | 1-7             | SUN-SAT , - * ? / L C # |      |
| 年（可选） | 留空, 1970-2099 | - * /                   |      |

- `*` 表示所有值；
- `?` 表示未说明的值，即不关心它为何值；
- `-` 表示一个指定的范围；
- `,` 表示附加一个可能值；
- `/` 符号前表示开始时间，符号后表示每次递增的值；
- `L`("last") ("last") "L" 用在day-of-month字段意思是 "这个月最后一天"；用在 day-of-week字段, 它简单意思是 "7" or "SAT"。 如果在day-of-week字段里和数字联合使用，它的意思就是 "这个月的最后一个星期几" – 例如： "6L" means "这个月的最后一个星期五". 当我们用“L”时，不指明一个列表值或者范围是很重要的，不然的话，我们会得到一些意想不到的结果。
- `W`("weekday") 只能用在day-of-month字段。用来描叙最接近指定天的工作日（周一到周五）。例如：在day-of-month字段用“15W”指“最接近这个 月第15天的工作日”，即如果这个月第15天是周六，那么触发器将会在这个月第14天即周五触发；如果这个月第15天是周日，那么触发器将会在这个月第 16天即周一触发；如果这个月第15天是周二，那么就在触发器这天触发。注意一点：这个用法只会在当前月计算值，不会越过当前月。“W”字符仅能在 day-of-month指明一天，不能是一个范围或列表。也可以用“LW”来指定这个月的最后一个工作日。 
- `#` 只能用在day-of-week字段。用来指定这个月的第几个周几。例：在day-of-week字段用"6#3"指这个月第3个周五（6指周五，3指第3个）。如果指定的日期不存在，触发器就不会触发。 
C 指和calendar联系后计算过的值。例：在day-of-month 字段用“5C”指在这个月第5天或之后包括calendar的第一天；在day-of-week字段用“1C”指在这周日或之后包括calendar的第一天。

## cron表达式的案列

- 每五分钟  `*/5 * * * *`
- 每小时     `0 * * * *`
- 每天        `0 0 * * *` 或 `0 0 */1 * *`
- 每周的周日       `0 0 * * 0`
- 每月的1号        `0 0 1 * *`
- 每月的最后一天        `0 23 L * *`
- 每年的第一天       `0 0 1 1 *`
- 每年的最后一天       `0 0 31 12 *`
- 每周六、周日的1:10 `10 1 * * 6,0`

## 参考资料

- [crontab 每分鐘、每小時、每天、每週、每月、每年定時执行](https://www.796t.com/content/1548929169.html)
